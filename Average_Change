import random
import math
import matplotlib.pyplot as plt

NUM_SIMULATIONS = 10000
NUM_CARDS = 100

def initialize_deck():
    return list(range(1, NUM_CARDS + 1))

def calculate_variance(results):
    variance_sum = 0
    average_value = sum(results) / len(results)
    for i in range(len(results)):
        variance_sum += math.pow(results[i] - average_value, 2)
    return variance_sum / len(results)

simulation_results = []
original_deck = []
average_values = []
variance_values = []

for i in range(NUM_SIMULATIONS):
    match_counter = 0
    card_deck = initialize_deck()
    random.shuffle(card_deck)

    for j in range(len(card_deck)):
        if (card_deck[j] - 1) == j:
            match_counter += 1

    simulation_results.append(match_counter)
    average_values.append(sum(simulation_results) / len(simulation_results))
    variance_values.append(calculate_variance(simulation_results))

original_deck = initialize_deck()
simulation_numbers = list(range(1, NUM_SIMULATIONS + 1))

print("\nAverage: {0}".format(sum(simulation_results) / len(simulation_results)))
print("Variance: {0}".format(calculate_variance(simulation_results)))

plt.plot(simulation_numbers, average_values)
plt.xlabel("Number of Simulations")
plt.ylabel("Average")
plt.title("How the Average Changes Over the Simulations")
plt.savefig('modified_average_simulation_plot.png', dpi=300, bbox_inches='tight')
plt.show()
